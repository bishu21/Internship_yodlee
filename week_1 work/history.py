# -*- coding: utf-8 -*-
# *** Spyder Python Console History Log ***

## ---(Mon May 14 15:27:12 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Tue May 15 11:53:38 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Tue May 15 14:51:03 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
pip install tensorflow
!pip install tensorflow
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
!conda install tensorflow

## ---(Tue May 15 17:49:35 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Thu May 17 10:42:18 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Sat May 19 15:23:10 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/lstm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/lstm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(3)
tensorboard --logdir="graph"
tensorboard --logdir="tensorflow"
tensorboard 
tensorboard --logdir="C:\Users\bchaudhary\.spyder-py3"

## ---(Mon May 21 11:14:52 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/lstm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/lstm.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Mon May 21 11:47:30 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/lstm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/lstm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Tue May 22 10:51:43 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/temp.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/hmm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
df_new=df_last.groupby('YODLEE_MERCHANT_NAME')
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(df_new)
df.YODLEE_MERCHANT_NAME
df_new.groups()
df_new.groups
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(df_new.sum)
df_new = df_last.sort(by='YODLEE_MERCHANT_NAME')
df_new = df_last.sort_values(by='YODLEE_MERCHANT_NAME')
print(df_new)
print(df_new['counts'])
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Wed May 23 16:33:09 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Thu May 24 09:33:25 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/graph.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(train_input.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(train_input.shape)
linear_model = tf.matmul( w,x) + b
print(x.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(x.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(x.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
import numpy as np

a=np.ones(5)

print(a.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(train_input.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(x.shape)
print(train_input.shape)
print(x.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(tf.matmul(x,w))
print(x.shape)
print(train_input.shape)
print(tf.matmul(train_input,x)

print(tf.matmul(train_input,x)
)
print(tf.matmul(train_input,x))


runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(tf.matmul(train_input,x))
print(w.shape)
w= tf.Variable([.3,.3],tf.float32,shape=[1,2])
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(w.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(w.shape)
print(x.shape)
print(tf.matmul(x,w))
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(a.shape)
print(b.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
a=tf.Variable(np.ones(2))

tf.reshape(a,[1,2])
b = tf.constant(np.ones(2),shape=[2,1])
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(b.shape)
print(a.shape)
tf.reshape(a,[1,2])
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
for j in train_input:
    print(j)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
print(j.shape)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
train_input = ['{0:020b}'.format(i) for i in range(2**20)]
train_input = ['{0:020b}'.format(i) for i in range(2**20)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]

print(train_input)
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
train_input = ['{0:020b}'.format(i) for i in range(2**20)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]
train_input = ['{0:020b}'.format(i) for i in range(2**20)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]

print(train_input)
train_input = ['{0:020b}'.format(i) for i in range(2**20)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]

ti  = []
for i in train_input:
    temp_list = []
    for j in i:
            temp_list.append([j])
    ti.append(np.array(temp_list))

train_input = ti
train_input = ['{0:020b}'.format(i) for i in range(2**10)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]

ti  = []
for i in train_input:
    temp_list = []
    for j in i:
            temp_list.append([j])
    ti.append(np.array(temp_list))

train_input = ti
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
train_input = ['{0:020b}'.format(i) for i in range(2**10)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]

ti  = []
for i in train_input:
    temp_list = []
    for j in i:
            temp_list.append(j)
    ti.append(np.array(temp_list))

train_input = ti
print(train_input)
train_input = ['{0:020b}'.format(i) for i in range(2**10)]
shuffle(train_input)
train_input = [map(int,i) for i in train_input]

ti  = []
for i in train_input:
    temp_list = []
    for j in i:
            temp_list.append(j)
    ti.append(np.array(temp_list))

train_input = ti
print(train_input[:2])


train_output = []

for i in train_input:
    count = 0
    for j in i:
        if j== 0:
            count+=1
    temp_list = ([0]*1)
    if(count):
        temp_list[0]=0
    else :
        temp_list[0]=1
    train_output.append(temp_list)


print(train_output[:2])
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
d=tf.ones(5)
runfile('C:/Users/bchaudhary/.spyder-py3/test.py', wdir='C:/Users/bchaudhary/.spyder-py3')
test_input = train_input[NUM_EXAMPLES:]
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
pwd
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
test_input = train_input[NUM_EXAMPLES:]
test_output = train_output[NUM_EXAMPLES:]
train_input = train_input[:NUM_EXAMPLES]
train_output = train_output[:NUM_EXAMPLES]
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')

## ---(Fri May 25 11:15:56 2018)---
runfile('C:/Users/bchaudhary/.spyder-py3/hmm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/linear_model.py', wdir='C:/Users/bchaudhary/.spyder-py3')
runfile('C:/Users/bchaudhary/.spyder-py3/nltk_hmm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
import nltk
from nltk.corpus import treebank
train_data = treebank.tagged_sents()[:3000]
nltk.download('treebank')
import nltk
nltk.download()
runfile('C:/Users/bchaudhary/.spyder-py3/nltk_hmm.py', wdir='C:/Users/bchaudhary/.spyder-py3')
nltk.download('treebank')
nltk
import nltk
nltk.download('treebank')

## ---(Thu May 31 13:10:57 2018)---
runfile('C:/Users/bchaudhary/Desktop/small_task/pickle_test.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
def get_ygst_desc(row):
    
    digits = re.compile("\d")
    
    def tokenizer(desc):
        
        return digits.sub("0", "".join(desc.lower()))
    
    
    
    variant_str = tokenizer(row)
    
    variant_str = re.sub(' +',' ',variant_str)
    
    return variant_str

## ---(Thu May 31 14:06:56 2018)---
runfile('C:/Users/bchaudhary/Desktop/small_task/pickle_test.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
def get_ygst_desc(row):
    
    digits = re.compile("\d")
    
    def tokenizer(desc):
        
        return digits.sub("0", "".join(desc.lower()))
    
    
    
    variant_str = tokenizer(row)
    
    variant_str = re.sub(' +',' ',variant_str)
    
    return variant_str
example_dict=example_dict.filter(items=['tag_sequence', 'description_unmasked','yodlee_name'])
new_df=example_dict[:20]
import re
new_df['ysgt'] =new_df['description_unmasked'].apply(lambda x:get_ygst_desc(x))
new_df=new_df.dropna()
def find_vendor(x):
    
    temp=x['tag_sequence'].split(" ")
    temp1= x['ysgt'].split(" ")

#     print (temp)
#     print(temp1[1])
    
    if(len(temp)==len(temp1)):
        ans=[]
        s=""
        count=0
        for i in range(len(temp)):
            
            if(temp[i]=='<vendor_name>' and count==0):
                s=temp1[i]+" "
                count=1
            elif(temp[i]=='<vendor_name>' and count==1):
                s=s+temp1[i]+" "
                count=1
            elif(count==1):
                s=s[:-1]
                ans.append(s)
                s=""
                count=0
        return ans
train_s=[]
new_df[new_df['tag_sequence'].map(len) == new_df['ysgt'].map(len)]
print(new_df)
#train_s.append(f[['tag_sequence','ysgt']].apply(find_vendor,axis=1))
train_s.append(f[['tag_sequence','ysgt']].apply(find_vendor,axis=1))
train_s.append(new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1))
print (train_s)
new_df=example_dict[:20]
import re
new_df['ysgt'] =new_df['description_unmasked'].apply(lambda x:get_ygst_desc(x))

new_df=new_df.dropna()
new_df[new_df['tag_sequence'].map(len) == new_df['ysgt'].map(len)]
print(new_df)
new_df['vendor_name']=new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
new=new_df.groupby(('yodlee_name'))['vendor_name'].apply(sum)
def find_vendor(x):
    
    temp=x['tag_sequence'].split(" ")
    temp1= x['ysgt'].split(" ")

#     print (temp)
#     print(temp1[1])
    
    if(len(temp)==len(temp1)):
        ans=[]
        s=""
        count=0
        for i in range(len(temp)):
            
            if(temp[i]=='<vendor_name>' and count==0):
                s=temp1[i]+" "
                count=1
            elif(temp[i]=='<vendor_name>' and count==1):
                s=s+temp1[i]+" "
                count=1
            elif(count==1):
                s=s[:-1]
                ans.append(s)
                s=""
                count=0
        return ans  
    else:
        return ans
train_s=[]
#new_df[new_df['tag_sequence'].map(len) == new_df['ysgt'].map(len)]
print(new_df)
new_df['vendor_name']=new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
new_df['vendor_name']=new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
def find_vendor(x):
    
    temp=x['tag_sequence'].split(" ")
    temp1= x['ysgt'].split(" ")

#     print (temp)
#     print(temp1[1])
    
    if(len(temp)==len(temp1)):
        ans=[]
        s=""
        count=0
        for i in range(len(temp)):
            
            if(temp[i]=='<vendor_name>' and count==0):
                s=temp1[i]+" "
                count=1
            elif(temp[i]=='<vendor_name>' and count==1):
                s=s+temp1[i]+" "
                count=1
            elif(count==1):
                s=s[:-1]
                ans.append(s)
                s=""
                count=0
        return ans  
    else:
        return ans
new_df['vendor_name']=new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
def find_vendor(x):
    
    temp=x['tag_sequence'].split(" ")
    temp1= x['ysgt'].split(" ")

#     print (temp)
#     print(temp1[1])
    ans=[]
    if(len(temp)==len(temp1)):
        
        s=""
        count=0
        for i in range(len(temp)):
            
            if(temp[i]=='<vendor_name>' and count==0):
                s=temp1[i]+" "
                count=1
            elif(temp[i]=='<vendor_name>' and count==1):
                s=s+temp1[i]+" "
                count=1
            elif(count==1):
                s=s[:-1]
                ans.append(s)
                s=""
                count=0
        return ans  
    else:
        return ans
new_df['vendor_name']=new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
new=new_df.groupby(('yodlee_name'))['vendor_name'].apply(sum)
runfile('C:/Users/bchaudhary/Desktop/small_task/pickle_test.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
import pandas as pd

import json
import glob
import zipfile  
l=['ADVENTURE ISLAND']
count=0
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
   			gf=pd.read_json(filename)
   			gf=gf[['description_unmasked','yodlee_name','tag_sequence']]

#   			gf[gf['yodlee_name'] is in (l)]
   			gf=gf.head(3)
      
   			if(count==0):
   				final=gf
   			else:	
   				frame=[final,gf]
   				final=pd.concat(frame)
   			print(len(final))
   			count+=1
   			if(count==1):
   				break
#
count=0
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
   			gf=pd.read_json(filename)
          break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
   			gf=pd.read_json(filename)
               break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
   			gf=pd.read_json(filename)
          break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
   			gf=pd.read_json(filename)
               break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
       		print(filename)  
       		gf=pd.read_json(filename)
              break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
       	   print(filename)  
       	   gf=pd.read_json(filename)
              break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
   			gf=pd.read_json(filename)
   			gf=gf[['description_unmasked','yodlee_name','tag_sequence']]

#   			gf[gf['yodlee_name'] is in (l)]
   			gf=gf.head(3)
      
   			if(count==0):
   				final=gf
   			else:	
   				frame=[final,gf]
   				final=pd.concat(frame)
   			print(len(final))
   			count+=1
   			if(count==1):
   				break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
    
    for filename in z.namelist():
      
      
   		 if(filename not in "16_quarter_1400_merch_with_YGST/"):
            
            
   			      print(filename)
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
    
    for filename in z.namelist():
      
      
   		 if(filename not in "16_quarter_1400_merch_with_YGST/"):
            
            
   			      print(filename)  
   			      gf=pd.read_json(filename)
                break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
    
    for filename in z.namelist():
      
      
   		 if(filename not in "16_quarter_1400_merch_with_YGST/"):
            
            
   			      print(filename)  
   			      gf=pd.read_json(filename)
                     break
runfile('C:/Users/bchaudhary/Desktop/small_task/read_json1.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
import pandas as pd

import json
import glob

count=0
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
   		count+=1
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)
   			gf=pd.read_json(filename)
       if(count==1):
          break
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
      
   			if(count==0):
   				final=gf
   			else:	
   				frame=[final,gf]
   				final=pd.concat(frame)
   			print(len(final))
   			count+=1
   			if(count==1):
   				break
runfile('C:/Users/bchaudhary/Desktop/small_task/read_json1.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
final
count=0
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
   for filename in z.namelist():
     
   		if(filename not in "16_quarter_1400_merch_with_YGST/"):
   			print(filename)  
      
   			if(count==0):
   				final=gf
   			else:	
   				frame=[final,gf]
   				final=pd.concat(frame)
   			print(len(final))
   			count+=1
   			if(count==1):
   				break
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
    
    for filename in z.namelist():
      
   		 count+=1
   		 if(filename not in "16_quarter_1400_merch_with_YGST/"):
                
                
                
                print(filename)
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
    
    for filename in z.namelist():
      
   		 count+=1
   		 if(filename not in "16_quarter_1400_merch_with_YGST/"):
                print(filename)
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
path = r'C:\Users\bchaudhary\Desktop\16_Quarter_Output\1449_merchants.txt'


lis=[]

with open(path, 'r') as f:
    for line in f:
        line=line.strip()
        lis.append(line)
pickle_in = open("train_output.pkl","rb")
example_dict = pickle.load(pickle_in)
print (example_dict[:5])
import pandas
import pickle
pickle_in = open("train_output.pkl","rb")
example_dict = pickle.load(pickle_in)
print (example_dict[:5])
def get_ygst_desc(row):
    
    digits = re.compile("\d")
    
    def tokenizer(desc):
        
        return digits.sub("0", "".join(desc.lower()))
    
    
    
    variant_str = tokenizer(row)
    
    variant_str = re.sub(' +',' ',variant_str)
    
    return variant_str
example_dict=example_dict.filter(items=['tag_sequence', 'description_unmasked','yodlee_name'])
example_dict[example_dict['yodlee_name'].isin(lis)]
example_dict=example_dict[example_dict['yodlee_name'].isin(lis)]
new_df=example_dict
#new_df.to_excel("after_given_funxtion.xlsx")
import re
new_df['ysgt'] =new_df['description_unmasked'].apply(lambda x:get_ygst_desc(x))

new_df=new_df.dropna()
def find_vendor(x):
    
    temp=x['tag_sequence'].split(" ")
    temp1= x['ysgt'].split(" ")

#     print (temp)
#     print(temp1[1])
    ans=[]
    if(len(temp)==len(temp1)):
        
        s=""
        count=0
        for i in range(len(temp)):
            
            if(temp[i]=='<vendor_name>' and count==0):
                s=temp1[i]+" "
                count=1
            elif(temp[i]=='<vendor_name>' and count==1):
                s=s+temp1[i]+" "
                count=1
            elif(count==1):
                s=s[:-1]
                ans.append(s)
                s=""
                count=0
        return ans  
    else:
        return ans

train_s=[]
new_df['vendor_name']=new_df[['tag_sequence','ysgt']].apply(find_vendor,axis=1)

new_df=new_df.groupby(('yodlee_name'))['vendor_name'].apply(sum)
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
import re
def get_ygst_desc(row):
    
    digits = re.compile("\d")
    
    def tokenizer(desc):
        
        return digits.sub("0", "".join(desc.lower()))
    
    
    
    variant_str = tokenizer(row)
    
    variant_str = re.sub(' +',' ',variant_str)
    
    return variant_str



train['ysgt'] =train['description_unmasked'].apply(lambda x:get_ygst_desc(x))
import re
def get_ygst_desc(row):
    
    digits = re.compile("\d")
    
    def tokenizer(desc):
        
        return digits.sub("0", "".join(desc.lower()))
    
    
    
    variant_str = tokenizer(row)
    
    variant_str = re.sub(' +',' ',variant_str)
    
    return variant_str



train['ysgt'] =train['description'].apply(lambda x:get_ygst_desc(x))
train=train.dropna()

def find_vendor(x):
    
    temp=x['tag_sequence'].split(" ")
    temp1= x['ysgt'].split(" ")

#     print (temp)
#     print(temp1[1])
    ans=[]
    if(len(temp)==len(temp1)):
        
        s=""
        count=0
        for i in range(len(temp)):
            
            if(temp[i]=='<vendor_name>' and count==0):
                s=temp1[i]+" "
                count=1
            elif(temp[i]=='<vendor_name>' and count==1):
                s=s+temp1[i]+" "
                count=1
            elif(count==1):
                s=s[:-1]
                ans.append(s)
                s=""
                count=0
        return ans  
    else:
        return ans


train['vendor_name']=train[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
new_df=new_df.groupby(('tde_yodlee_name'))['vendor_name'].apply(sum)
train=train.groupby(('tde_yodlee_name'))['vendor_name'].apply(sum)
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
n=train
n=n.groupby(('tde_yodlee_name'))['vendor_name'].apply(sum)
n=train
n=n.groupby(('tde_yodlee_name'))['vendor_name','16_Quarter_Count].apply(sum)
n=train[['tde_yodlee_name','vendor_name','16_Quarter_Count'] ]
n=n.groupby(('tde_yodlee_name'))['vendor_name','16_Quarter_Count].apply(sum)
n=n.groupby(('tde_yodlee_name'))['vendor_name','16_Quarter_Count'].apply(sum)
train['vendor_name']=train[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
train=train[['tde_yodlee_name','vendor_name','16_Quarter_Count'] ]           

train=train.groupby(('tde_yodlee_name'))['vendor_name','16_Quarter_Count'].apply(sum)
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
runfile('C:/Users/bchaudhary/Desktop/small_task/pickle_test.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
import pandas as pd
data1 = pd.ExcelFile("after_given_funxtion.xlsx")
print( pd.merge(data1,train,on='Index'))
print( pd.merge(data1,train,on='vendor_name'))
data1 = pd.ExcelFile("after_given_funxtion.xlsx")
print(data1[:3])
data1 = pd.read_excel("after_given_funxtion.xlsx")
print( pd.merge(data1,train,on='Index'))
print( pd.merge(data1,train)
print( pd.merge(data1,train))
print (train.reset_index())
train=train.reset_index()
train=train.rename(cols={'tde_yodlee_name':'yodlee_name'})
train=train.rename(columns={'tde_yodlee_name':'yodlee_name'})
train=train.rename(columns={'vendor_name':'vendor_name1'})
new_df=new_df.reset_index()

new_df.to_excel("after_given_funxtion.xlsx")
data1 = pd.read_excel("after_given_funxtion.xlsx")

print(data1[:3])


print( pd.merge([data1,train],on='yodlee_name'))
print( pd.merge(data1,train,on='yodlee_name'))
let= pd.merge(data1,train,on='yodlee_name')
import pandas as pd

import json
import glob


path = r'C:\Users\bchaudhary\Desktop\16_Quarter_Output\1449_merchants.txt'


lis=[]

with open(path, 'r') as f:
    for line in f:
        line=line.strip()
        lis.append(line)





import zipfile 

l=['ADVENTURE ISLAND']
train = pd.DataFrame()
count=0
with zipfile.ZipFile("16_quarter_1400_merch_with_YGST.zip", "r") as z:
  for filename in z.namelist():
     if(filename not in "16_quarter_1400_merch_with_YGST/"):
        print(filename)  
        with z.open(filename) as f:  
         data = f.read()  
         d = json.loads(data.decode("utf-8"))
         
         d = pd.DataFrame(d['transaction_list'],dtype=object)

#             train = (pd.DataFrame.from_dict(word, orient='index'))
         train = train.append(d,ignore_index=True)
         train=train[train['tde_yodlee_name'].isin(lis)]
         
         
         import re
         def get_ygst_desc(row):
             
             digits = re.compile("\d")
             
             def tokenizer(desc):
                 
                 return digits.sub("0", "".join(desc.lower()))
             
             
             
             variant_str = tokenizer(row)
             
             variant_str = re.sub(' +',' ',variant_str)
             
             return variant_str
         
         
         train['ysgt'] =train['description'].apply(lambda x:get_ygst_desc(x))              
         
         
         train=train.dropna()
         
         def find_vendor(x):
             
             temp=x['tag_sequence'].split(" ")
             temp1= x['ysgt'].split(" ")
        #     print (temp)
        #     print(temp1[1])
             ans=[]
             if(len(temp)==len(temp1)):
                 
                 s=""
                 count=0
                 for i in range(len(temp)):
                     
                     if(temp[i]=='<vendor_name>' and count==0):
                         s=temp1[i]+" "
                         count=1
                     elif(temp[i]=='<vendor_name>' and count==1):
                         s=s+temp1[i]+" "
                         count=1
                     elif(count==1):
                         s=s[:-1]
                         ans.append(s)
                         s=""
                         count=0
                 return ans  
             else:
                 return ans
         
         
         train['vendor_name']=train[['tag_sequence','ysgt']].apply(find_vendor,axis=1)
         train=train[['tde_yodlee_name','vendor_name','16_Quarter_Count'] ]           
         
         train=train.groupby(('tde_yodlee_name'))['vendor_name','16_Quarter_Count'].apply(sum)  
         
         train=train.reset_index()
         
         train=train.rename(columns={'vendor_name':'vendor_name1'})
         break
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
train=train.rename(columns={'tde_yodlee_name':'yodlee_name','vendor_name':'vendor_name1'})
data1 = pd.read_excel("after_given_funxtion.xlsx")

print(data1[:3])
let= pd.merge(data1,train,on='yodlee_name')
string_list=let['vendor_name'][0]+let['vendor_name1'][0]
print (let['vendor_name'][0])
print (let['vendor_name1'][0])
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
print (let['vendor_name1'][0])
string_list=let['vendor_name'][0]
string2=let['vendor_name1'][0]
string_list=list[let['vendor_name'][0]]
string_list=let['vendor_name'][0]
string_list=let['vendor_name'][0].split()
string_list=let['vendor_name'][0]
string_list=let['vendor_name'][0].split()
string_list=let['vendor_name'][0]
print(type(data1['vendor_name']))
string_list=let['vendor_name'][0].split(",")
print (string_list[0])
print (string_list[1])
string_list=let['vendor_name'][0]
runfile('C:/Users/bchaudhary/Desktop/small_task/pickle_test.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
import pickle

pickle_in = open("Fruits.obj","rb")
data1 = pickle.load(pickle_in)
print(type(data1['vendor_name']))
print(type(data1['vendor_name'][0]))
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
def string_set(string_list):
    return set(i for i in string_list 
               if not any(i in s for s in string_list if i != s))


l1=string_set(string_list)
print(l1)
print(len(l1))
string_list=let['vendor_name'][0]
l2=set(string_list)
print(len(l1-l2))
filehandler = open("Frits.obj","wb")
filehandler = open(line+"Frits.obj"+line,"wb")
filehandler = open("fru\Frits.obj"+line,"wb")
runfile('C:/Users/bchaudhary/Desktop/small_task/read.py', wdir='C:/Users/bchaudhary/Desktop/small_task')
train=train.groupby(('tde_yodlee_name')).apply(sum)

## ---(Mon Jun  4 19:47:39 2018)---
import pickle


path = r'C:\Users\bchaudhary\Desktop\16_Quarter_Output\1449_merchants.txt'


lis=[]

with open(path, 'r') as f:
    for line in f:
        line=line.strip()
        lis.append(line)




pickle_in = open("train_output.pkl","rb")
example_dict = pickle.load(pickle_in)
print (example_dict[:5])
def get_ygst_desc(row):
    
    digits = re.compile("\d")
    
    def tokenizer(desc):
        
        return digits.sub("0", "".join(desc.lower()))
    
    
    
    variant_str = tokenizer(row)
    
    variant_str = re.sub(' +',' ',variant_str)
    
    return variant_str
example_dict=example_dict.filter(items=['tag_sequence', 'description_unmasked','yodlee_name'])
example_dict=example_dict[example_dict['yodlee_name'].isin(lis)]
new_df=example_dict
import re
new_df['ysgt'] =new_df['description_unmasked'].apply(lambda x:get_ygst_desc(x))

new_df=new_df.dropna()
def find_vendor(x):
     
     temp=x['tag_sequence'].split(" ")
     temp1= x['ysgt'].split(" ")
     
     s=""
     if(len(temp)==len(temp1)):
         
         
         count=0
         for i in range(len(temp)):
             
             if(temp[i]=='<vendor_name>' and count==0):
                 s=temp1[i]+" "
                 count=1
             elif(temp[i]=='<vendor_name>' and count==1):
                 s=s+temp1[i]+" "
                 count=1
             elif(count==1):
                 s=s[:-1]
                 return s 
     
     else:
         return s
new_df['vendor_name']=new_df.apply(find_vendor,axis=1)
new_df=new_df[['yodlee_name','vendor_name']]
new_df=new_df.groupby(('yodlee_name'))['vendor_name'].apply(set)
new_df=new_df.reset_index()
filehandler = open("Final_training.obj"+line,"wb")
pickle.dump(new_df,filehandler)
filehandler.close()
filter(None, new_df)
r=filter(None, new_df['vendor_name'])